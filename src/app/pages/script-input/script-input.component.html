<div class="min-h-screen bg-[#0f172a] text-white font-['Outfit'] flex items-center justify-center p-4">
    <app-subtitle-editor [isOpen]="subtitleEditorOpen()" [settings]="subtitleSettings()" (close)="closeSubtitleEditor()"
        (settingsChange)="updateSubtitleSettingsLocal($event)" (saveSettings)="saveSubtitleSettings($event)">
    </app-subtitle-editor>

    <div class="w-full max-w-5xl">
        <!-- Header -->
        <div class="mb-8 text-center">
            <h1
                class="text-4xl md:text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 to-cyan-400 mb-2">
                {{ 'VIDEO_CREATOR' | translate }}
            </h1>
            <p class="text-slate-400 text-lg">{{ 'SUBTITLE' | translate }}</p>
        </div>

        <!-- Main Card -->
        <div class="bg-slate-800/50 backdrop-blur-xl rounded-3xl border border-slate-700/50 p-6 md:p-8 shadow-2xl">
            @if (processingStatus() === 'input') {
            <app-script-form [isSubmitting]="isSubmitting()" [errorMessage]="errorMessage()"
                (formSubmit)="handleScriptSubmit($event)">
            </app-script-form>
            }

            @else if (processingStatus() === 'processing') {
            <div class="flex flex-col items-center justify-center py-12">
                <div class="animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-indigo-500 mb-4"></div>
                <p class="text-xl text-slate-300">{{ 'PROCESSING' | translate }}...</p>
                <p class="text-sm text-slate-500 mt-2">{{ 'WAITING_MSG' | translate }}</p>
            </div>
            }

            @else if (processingStatus() === 'preview') {
            <div class="w-full">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-white">{{ 'PREVIEW_TITLE' | translate }}</h2>
                    <button (click)="finalizeVideo()"
                        class="px-6 py-2 bg-gradient-to-r from-indigo-600 to-cyan-600 rounded-lg text-white font-bold hover:scale-105 hover:shadow-lg hover:shadow-indigo-500/30 active:scale-95 transition-all cursor-pointer">
                        {{ 'FINALIZE_VIDEO' | translate }}
                    </button>
                </div>

                <app-preview-player [activeImage]="activeImage()" [previousImage]="previousImage()"
                    [activeSubtitle]="activeSubtitle()" [subtitleSettings]="subtitleSettings()"
                    [showSubtitles]="showSubtitles()" [isPlaying]="playerService.isPlaying()"
                    [currentEffect]="currentEffect()" (togglePlay)="togglePlay()"
                    (toggleSubtitles)="toggleSubtitles($event)">
                </app-preview-player>

                <app-subtitle-settings-panel [subtitleSettings]="subtitleSettings()"
                    (openSubtitleEditor)="openSubtitleEditor()" (toggleSubtitles)="toggleSubtitles($event)">
                </app-subtitle-settings-panel>

                <app-thumbnail-editor [thumbnailUrl]="thumbnailUrl()" [prompt]="thumbnailPrompt()"
                    [isLoading]="isThumbnailLoading()" (regenerate)="regenerateThumbnail($event)"
                    (upload)="uploadThumbnail($event)">
                </app-thumbnail-editor>

                <app-segment-list [projectData]="projectData()" [projectId]="projectId()"
                    [subtitleSettings]="subtitleSettings()"
                    (regenerateImage)="regenerateImage($event.index, $event.prompt)"
                    (uploadImage)="uploadImage($event.index, $event.file)" (updateSubtitle)="updateSubtitle()">
                </app-segment-list>
            </div>
            }

            @else if (processingStatus() === 'generating') {
            <div class="flex flex-col items-center justify-center py-12">
                <div class="animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-green-500 mb-4"></div>
                <p class="text-xl text-slate-300">{{ 'GENERATING_FINAL' | translate }}...</p>
                <p class="text-sm text-slate-500 mt-2">{{ 'WAITING_MSG' | translate }}</p>
            </div>
            }

            @else if (processingStatus() === 'completed') {
            <app-video-result [videoUrl]="videoUrl()" (onBack)="resetForm()">
            </app-video-result>
            }
        </div>
    </div>
</div>